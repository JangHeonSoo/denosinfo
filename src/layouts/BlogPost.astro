---
import type { CollectionEntry } from 'astro:content'
import type { MarkdownHeading } from 'astro'
import { Image } from 'astro:assets'
import BaseLayout from '@/layouts/BaseLayout'
import FormattedDate from '@/components/FormattedDate'
import Tag from '@/components/Tag'
import Giscus from '@/components/Giscus'
import Share from '@/components/Share'

type Props = {
	id: CollectionEntry<'blog'>['id']
	data: CollectionEntry<'blog'>['data']
	headings: MarkdownHeading[]
	readTime: string
}

const { data, readTime, headings, id } = Astro.props
const { title, description, pubDate, heroImage, tags, comments, category } = data

const articleDate = pubDate.toISOString()
---

<BaseLayout
	title={title}
	description={description}
	image={heroImage?.src}
	articleDate={articleDate}
>
	<article class='min-w-full md:py-4 sm:max-w-none md:max-w-none'>
        <!-- Hero Header -->
		<header class='mb-12 xl:pb-12 xl:mb-16 border-b border-gray-200 dark:border-gray-800 text-center max-w-5xl mx-auto'>
			<div class='flex items-center justify-center gap-x-4 mb-6'>
                {category && (
                    <span class='inline-flex items-center justify-center px-4 py-1.5 bg-primary/10 dark:bg-primary/20 text-primary dark:text-primary-300 text-sm font-bold rounded-full uppercase tracking-wider'>
                        {category}
                    </span>
                )}
				<div class='flex items-center gap-2 text-gray-500 font-medium'>
                    <FormattedDate date={pubDate} />
                    <span>â€¢</span>
                    <span>{readTime}</span>
                </div>
			</div>

			<h1 class='text-4xl md:text-5xl lg:text-7xl font-heading font-black tracking-tighter mb-8 text-gray-900 dark:text-white leading-tight'>
				{title}
			</h1>

            <!-- Tags -->
            <div class='flex flex-wrap justify-center items-center gap-3 mb-10'>
				{tags.map((tag) => <Tag tag={tag} />)}
			</div>

            {heroImage && (
                <div class='relative w-full aspect-video rounded-3xl overflow-hidden shadow-2xl my-8 md:my-10 group'>
					<Image
						src={heroImage}
						width={1200}
						height={600}
						quality={100}
						format='jpg'
						loading='eager'
						class='w-full h-full object-cover group-hover:scale-105 transition-transform duration-700 ease-out'
						alt={`img of ${title}`}
					/>
                </div>
            )}
		</header>

		<div class='max-w-5xl mx-auto'>
            <!-- Main Content -->
			<div class='prose prose-xl prose-slate dark:prose-invert max-w-none
                prose-headings:font-heading prose-headings:font-bold prose-headings:tracking-tight
                prose-p:leading-relaxed prose-p:text-lg
                prose-a:text-primary prose-a:no-underline hover:prose-a:underline
                prose-img:rounded-3xl prose-img:shadow-2xl prose-img:w-full prose-img:my-12
                prose-pre:rounded-2xl prose-pre:shadow-lg
                prose-li:text-lg
            '>
				<slot />
                
                <!-- Share Section -->
                <div class="mt-20 pt-10 border-t border-gray-200 dark:border-gray-800">
                    <h3 class="text-2xl font-bold mb-8 flex items-center gap-3">
                        Share this article
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>
                    </h3>
                    <Share post={data} />
                </div>
			</div>
		</div>
	</article>
	<Giscus enabled={comments} />
</BaseLayout>

<script src='https://platform.twitter.com/widgets.js' async></script>
